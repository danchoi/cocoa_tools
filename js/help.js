/* Copyright Â© 2010 Apple Inc.  All rights reserved. */
function storeLocally(a,b){if((localStorage!==null)&&(typeof localStorage!=="undefined")){try{localStorage.setItem(a,b)}catch(c){}}}function retrieveLocally(a){var b;
if((localStorage!==null)&&(typeof localStorage!=="undefined")){try{b=localStorage.getItem(a)}catch(c){}}return b}var SectionMixin;
var AppleHelp={init:function(){var a=$("book-json"),b=$("identifier");
if(!a){return}this.docAref=b?b.content:null;
this.getJSON(a.content,this.jsonDidLoad.bind(this));
document.body.addEventListener("click",this);
Event.observe(window,"popstate",function(c){this.loadLink(window.location.href,null,true)}.bindAsEventListener(this))},activeSection:null,getCurrentlyOpenTOCSections:function(){var a=retrieveLocally(this.docAref+"-open");
return a?a.split(","):[]},isActiveTOCSection:function(a){return(!a.parent)?window.location.href.match(a.href.replace(/\#.*$/,""))!==null:(window.location.hash.replace("#","")===a.aref)},setActiveTOCSection:function(){if(this.activeSection){this.activeSection.deactivate()}this.activeSection=null;
var b=this;
function a(d){for(var c=0;
c<d.length;
c++){if(b.isActiveTOCSection(d[c])){b.activeSection=d[c]}if(d[c].sections&&d[c].sections.length>0){a(d[c].sections)}}}a(this.toc.sections);
if(this.activeSection){this.activeSection.activate()}},populateTOC:function(a){if(!this.tocLayer){this.buildTOC()}a.sections.forEach(function(b){Object.extend(b,SectionMixin);
if(a.bookRoot){b.bookRoot=a.bookRoot}b.init(this.tocLayer)}.bind(this));
this.toc=a;
if(this.activeSection){
  this.activeSection.activate();
  window.history.replaceState({aref:this.activeSection.aref},document.title,window.location.href)}this.updateNavLinks()},getJSON:function(a,d,b){var c=new Ajax.Request(a,{onSuccess:function(e){var f=JSON.parse(e.responseText);

if(b){
  this.docAref="//apple_ref/doc/uid/"+f.uid;
  f.bookRoot=b
}

  d(f).bind(this)}.bind(this)})},jsonDidLoad:function(b){if(b.books){this.library=b;
if(this.library.books.length>1){}else{var a=this.library.books[0];
this.getJSON(a.root+a.json,this.populateTOC.bind(this),a.root);
this.buildSplashPage()}}else{this.populateTOC(b)}},loadLink:function(b,c,a){c=c||"";
if(!a){window.history.pushState({aref:c.aref},"",b);
AppleHelp.newLocation=b}var d=new Ajax.Request(b,{onSuccess:function(g){var k=g.responseText,e=$("contents"),f=document.createElement("div"),h,j,i,l;
f.innerHTML=k;
e.removeClassName("splash");
e.innerHTML=f.down("#contents").innerHTML;
j=k.match(/name=\"book-root\"\s+content=\".*\"/)[0].split("=").last().replace(/\"/g,"");
i=$("book-root");
if(!i){i=document.createElement("meta");
i.id="book-root";
i.name="book-root";
document.head.appendChild(i)}if(!i.content||i.content!==j){i.content=j;
AppleHelp.updateTOCLinks()}AppleHelp.setActiveTOCSection();
l=k.match(/\<title\>(.*)\<\/title\>/)[0].stripTags();
document.title=l;
Tasks.init({tasksClosed:true});
h=document.getElementsByName(window.location.hash.replace("#",""))[0];
if(h){h.scrollIntoView()}else{e.scrollTop=0}if(!a){window.history.replaceState({aref:c.aref},l,b)}}})},hrefIsNewPage:function(a){return(a&&a!==window.location.href&&!a.match(window.location.pathname))},handleEvent:function(a){if(a.type!="click"){return}switch(a.target.localName){case"a":if(/^https?:\/\//.match(link)){return true}if(this.hrefIsNewPage(a.target.href)){this.loadLink(a.target.href);
a.preventDefault()}break;
default:break}},tocLayer:null,buildTOC:function(){this.tocLayer=new Element("ul");
this.tocLayer.addClassName("toc");
document.body.appendChild(this.tocLayer)},buildNavLinks:function(){this.pageLinkBackground=document.createElement("div");
this.pageLinkBackground.id="page-links";
document.body.appendChild(this.pageLinkBackground);
this.prevLink=document.createElement("a");
this.prevLink.id="previous-page-link";
document.body.appendChild(this.prevLink);
this.nextLink=document.createElement("a");
this.nextLink.id="next-page-link";
document.body.appendChild(this.nextLink)},buildSplashPage:function(){var d,b,c,a=document.createElement("article");
document.title=this.library.title;
a.id="contents";
a.role="main";
a.addClassName("splash");
document.body.appendChild(a);
if(this.library.splash_image){d=document.createElement("img");
d.id="splash";
d.src=this.library.splash_image;
a.appendChild(d)}if(this.library.title){d=document.createElement("h1");
d.innerHTML=this.library.title;
a.appendChild(d)}if(this.library.subtitle){d=document.createElement("h2");
d.innerHTML=this.library.subtitle;
a.appendChild(d)}if(!this.isMinWebKitRevision()){d=document.createElement("a");
d.addClassName("update-safari");
d.href=CONFIG.safari_download_url?CONFIG.safari_download_url:"";
c=CONFIG.safari_upgrade_message?CONFIG.safari_upgrade_message:"";
d.innerHTML=c+"<div class='disclosure'></div>";
a.appendChild(d)}if(this.library.link){d=document.createElement("a");
d.addClassName("read-online");
d.href=this.library.link;
c=this.library.read_online_message?this.library.read_online_message:"";
d.innerHTML=c+"<div class='disclosure'></div>";
a.appendChild(d)}},updateTOCLinks:function(){var b=$("book-root"),a=b?b.content:null;
this.toc.sections.forEach(function(c){c.updateLink(a)})},updateNavLinks:function(){if(!this.prevLink||!this.nextLink){this.buildNavLinks()}function b(c){if(!c.parent){return c}return b(c.parent)}var a=this.activeSection?this.toc.sections.indexOf(b(this.activeSection)):0;
if(this.toc.sections[a-1]){this.prevLink.href=this.toc.sections[a-1].relativeHref;
this.prevLink.style.opacity=1}else{this.prevLink.href=null;
this.prevLink.style.opacity=0.33}if(this.toc.sections[a+1]){this.nextLink.href=this.toc.sections[a+1].relativeHref;
this.nextLink.style.opacity=1}else{if(!this.activeSection){this.nextLink.href=this.toc.sections[0].relativeHref;
this.nextLink.style.opacity=1}else{this.nextLink.href=null;
this.nextLink.style.opacity=0.33}}},isMinWebKitRevision:function(){if(CONFIG&&CONFIG.min_webkit_revision&&Prototype.Browser.WebKit){var a=parseFloat(navigator.userAgent.match(/AppleWebKit\/([^\s]+)/)[1]);
return a>=CONFIG.min_webkit_revision}return null}};
SectionMixin={domLayer:null,init:function(a,d){this.parent=d;
this.active=AppleHelp.isActiveTOCSection(this);
if(this.active){AppleHelp.activeSection=this}if(!this.bookRoot){var b=$("book-root");
if(b){this.bookRoot=b.content}else{if(this.parent){this.bookRoot=this.parent.bookRoot}}}this.relativeHref=this.bookRoot?this.bookRoot+this.href:this.href;
this.build();
if(!this.domLayer){return}a.appendChild(this.domLayer);
this.startObservers();
var c=AppleHelp.getCurrentlyOpenTOCSections();
if(c.length>0&&c.indexOf(this.aref)>=0){this.openSection()}},build:function(){var a="closed",b;
this.domLayer=new Element("li");
this.domLayer.innerHTML="<div class='disclosure'></div><a href='"+this.relativeHref+"'>"+this.title+"</a>";
if(!this.sections||this.sections.length<1){this.domLayer.addClassName("single");
return}b=this.domLayer.appendChild(new Element("ul"));
this.sections.forEach(function(c){Object.extend(c,SectionMixin);
c.init(b,this)}.bind(this))},openSection:function(){if(this.domLayer.hasClassName("single")){this.openParents();
return}var a=AppleHelp.getCurrentlyOpenTOCSections();
if(a.indexOf(this.aref)<0){a.push(this.aref);
storeLocally(AppleHelp.docAref+"-open",a.uniq())}this.domLayer.addClassName("open");
this.openParents()},openParents:function(){if(this.parent){this.parent.openSection()}},closeSection:function(){var a=AppleHelp.getCurrentlyOpenTOCSections();
a=a.without(this.aref);
storeLocally(AppleHelp.docAref+"-open",a.uniq());
this.domLayer.removeClassName("open");
this.closeChildren()},closeChildren:function(){this.sections.forEach(function(a){a.closeSection()})},toggleSection:function(){if(this.domLayer.hasClassName("open")){this.closeSection()}else{this.openSection()}},activate:function(){if(AppleHelp.activeSection&&AppleHelp.activeSection!==this){AppleHelp.activeSection.deactivate()}AppleHelp.activeSection=this;
this.domLayer.addClassName("active");
AppleHelp.updateNavLinks()},deactivate:function(){this.domLayer.removeClassName("active");
AppleHelp.activeSection=null},updateLink:function(a){if(a){this.bookRoot=a}else{if(this.parent){this.bookRoot=this.parent.bookRoot}}this.relativeHref=this.bookRoot?this.bookRoot+this.href:this.href;
this.domLayer.down("a").href=this.relativeHref;
if(!this.sections){return}this.sections.forEach(function(b){b.updateLink()})},startObservers:function(){this.domLayer.down(".disclosure").observe("click",function(a){this.toggleSection()}.bindAsEventListener(this))}};
Event.observe(window,"dom:loaded",function(){AppleHelp.init()});

